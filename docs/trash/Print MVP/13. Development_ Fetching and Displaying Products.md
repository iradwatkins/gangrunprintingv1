**13\. Development: Fetching and Displaying Products\*\***

This step implements the functionality to retrieve a list of products from the Supabase database and render it on the "All Products" page. This serves as the first end-to-end test of the full stack, from frontend to backend. This is a primary task in **\*\*Epic 2\*\***.

**\*\*Actions Taken:\*\***

1\. **\*\*Create API Function:\*\*** A function is created in the \`src/api/\` directory to handle the logic for fetching products from the database using the Supabase client.  
2\. **\*\*Implement React Query:\*\*** The \`useQuery\` hook from **\*\*React Query\*\*** is used to call this API function, manage the loading and error states, and cache the fetched data.  
3\. **\*\*Update Page Component:\*\*** The \`AllProductsPage\` component is updated to use this hook and display the list of product names.

Here is the code for the data fetching function:

\`\`\`typescript  
// File: src/api/products.ts

import { supabase } from "@/lib/supabaseClient";

export const getProducts \= async () \=\> {  
 // Fetch data from the 'products' table in Supabase  
 const { data, error } \= await supabase.from('products').select('\*'); //

if (error) {  
 throw new Error(error.message);  
 }

return data;  
};  
\`\`\`

Here is the code for the updated page component that displays the data:

\`\`\`typescript  
// File: src/pages/AllProductsPage.tsx

import { useQuery } from '@tanstack/react-query'; //  
import { getProducts } from '@/api/products';  
import { Card, CardHeader, CardTitle } from '@/components/ui/card';

export function AllProductsPage() {  
 // Use React Query to fetch and cache the products data  
 const { data: products, isLoading, isError, error } \= useQuery({  
 queryKey: \['products'\],  
 queryFn: getProducts,  
 });

if (isLoading) {  
 return \<div className="p-8"\>\<span\>Loading products...\</span\>\</div\>;  
 }

if (isError) {  
 return \<div className="p-8"\>\<span\>Error: {error.message}\</span\>\</div\>;  
 }

return (  
 \<div className="p-8"\>  
 \<h1 className="text-3xl font-bold mb-6"\>Our Products\</h1\>  
 \<div className="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4"\>  
 {products?.map((product) \=\> (  
 \<Card key={product.id}\>  
 \<CardHeader\>  
 \<CardTitle\>{product.name}\</CardTitle\>  
 \</CardHeader\>  
 \</Card\>  
 ))}  
 \</div\>  
 \</div\>  
 );  
}  
\`\`\`
