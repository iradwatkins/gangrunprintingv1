**18\. Development: Shopping Cart & State Management\*\***

This step implements the client-side shopping cart. It involves creating a global state management solution to hold the cart's contents and updating the product page to add items to this cart. We will use **\*\*Zustand\*\***, a lightweight state management library mentioned as a preferred option in the technical guidelines, to manage the cart's state across the application.

**\*\*Actions Taken:\*\***

1\. **\*\*Install Zustand:\*\*** The \`zustand\` library is added to the project's dependencies.  
2\. **\*\*Create Cart Store:\*\*** A \`cartStore.ts\` is created using Zustand. This store will hold an array of cart items and provide actions like \`addItem\`, \`removeItem\`, and \`clearCart\`.  
3\. **\*\*Update Product Page:\*\*** The \`onSubmit\` function in \`ProductDetailPage.tsx\` is modified to call the \`addItem\` action from the cart store, adding the configured product and its options to the cart.  
4\. **\*\*Create Floating Side Cart Component:\*\*** A new \`FloatingSideCart.tsx\` component is built, as required by the UI/UX Specification. This component subscribes to the \`cartStore\` to display the current items and the total price.

Here is the code for the Zustand **\*\*Cart Store\*\***:

\`\`\`typescript  
// File: src/store/cartStore.ts

import { create } from 'zustand';

// Define the shape of a single item in the cart  
interface CartItem {  
 productId: number;  
 productName: string;  
 configuration: any; // This will hold the selected options  
 price: number;  
 quantity: number;  
}

// Define the shape of the store's state and actions  
interface CartState {  
 items: CartItem\[\];  
 addItem: (item: CartItem) \=\> void;  
 removeItem: (productId: number) \=\> void;  
 clearCart: () \=\> void;  
}

export const useCartStore \= create\<CartState\>((set) \=\> ({  
 items: \[\],  
 addItem: (item) \=\>  
 set((state) \=\> {  
 // Logic to handle existing items (e.g., increment quantity) can be added here  
 return { items: \[...state.items, item\] };  
 }),  
 removeItem: (productId) \=\>  
 set((state) \=\> ({  
 items: state.items.filter((item) \=\> item.productId \!== productId),  
 })),  
 clearCart: () \=\> set({ items: \[\] }),  
}));  
\`\`\`

Here is the **\*\*updated \`onSubmit\` function\*\*** in the \`ProductDetailPage.tsx\` component:

\`\`\`typescript  
// File: src/pages/ProductDetailPage.tsx (inside the component)

import { useCartStore } from '@/store/cartStore'; // Import the store

// ...

const { addItem } \= useCartStore(); // Get the addItem action

const onSubmit \= (data: ConfigurationFormData) \=\> {  
 if (\!product || calculatedPrice \=== null) {  
 alert("Please configure the product fully.");  
 return;  
 }

    // Add the configured item to the cart store
    addItem({
        productId: product.id,
        productName: product.name,
        configuration: data, // The selected options from the form
        price: calculatedPrice,
        quantity: 1, // Default quantity to 1 for now
    });

    alert(\`${product.name} has been added to your cart\!\`);

};

// ... (rest of the component)  
\`\`\`

Here is the code for the new **\*\*Floating Side Cart Component\*\***:

\`\`\`typescript  
// File: src/components/common/FloatingSideCart.tsx

import { useCartStore } from '@/store/cartStore';  
import { Button } from '@/components/ui/button';  
import { Sheet, SheetContent, SheetHeader, SheetTitle, SheetTrigger } from '@/components/ui/sheet'; // Shadcn/UI component for side panels

export function FloatingSideCart() {  
 const { items, removeItem } \= useCartStore();  
 const totalPrice \= items.reduce((total, item) \=\> total \+ item.price \* item.quantity, 0);

return (  
 \<Sheet\>  
 \<SheetTrigger asChild\>  
 \<Button variant="outline"\>View Cart ({items.length})\</Button\>  
 \</SheetTrigger\>  
 \<SheetContent\>  
 \<SheetHeader\>  
 \<SheetTitle\>Your Shopping Cart\</SheetTitle\>  
 \</SheetHeader\>  
 \<div className="py-4"\>  
 {items.length \=== 0 ? (  
 \<p\>Your cart is empty.\</p\>  
 ) : (  
 \<div className="space-y-4"\>  
 {items.map((item) \=\> (  
 \<div key={item.productId} className="flex justify-between items-center"\>  
 \<div\>  
 \<p className="font-semibold"\>{item.productName}\</p\>  
 \<p className="text-sm text-muted-foreground"\>\<span class="math-inline"\>\\{item\\.price\\.toFixed\\(2\\)\\}\</p\\\>  
\</div\\\>  
\<Button variant\\="ghost" size\\="sm" onClick\\=\\{\\(\\) \\=\\\> removeItem\\(item\\.productId\\)\\}\\\>  
Remove  
\</Button\\\>  
\</div\\\>  
\\)\\)\\}  
\</div\\\>  
\\)\\}  
\</div\\\>  
\<div className\\="mt\\-6 border\\-t pt\\-4"\\\>  
\<div className\\="flex justify\\-between font\\-bold text\\-lg"\\\>  
\<p\\\>Total\\:\</p\\\>  
\<p\\\>\</span\>{totalPrice.toFixed(2)}\</p\>  
 \</div\>  
 \<Button className="w-full mt-4"\>Proceed to Checkout\</Button\>  
 \</div\>  
 \</SheetContent\>  
 \</Sheet\>  
 );  
}  
\`\`\`
