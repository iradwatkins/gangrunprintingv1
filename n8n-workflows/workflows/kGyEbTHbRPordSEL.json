{"createdAt":"2025-10-20T13:42:13.417Z","updatedAt":"2025-10-20T22:49:06.000Z","id":"kGyEbTHbRPordSEL","name":"Daily VPS Health Report","active":true,"isArchived":false,"nodes":[{"parameters":{"rule":{"interval":[{"field":"cronExpression","expression":"0 8 * * *"}]}},"name":"Every Morning 8 AM","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[256,304],"id":"schedule-trigger"},{"parameters":{"command":"/usr/local/bin/vps-health-check.sh"},"name":"Run VPS Health Check","type":"n8n-nodes-base.executeCommand","typeVersion":1,"position":[480,304],"id":"health-check"},{"parameters":{"jsCode":"const data = JSON.parse($input.first().json.stdout);\n\n// Build report message\nlet message = `🖥️ *VPS DAILY HEALTH REPORT*\\n`;\nmessage += `📅 ${new Date(data.timestamp).toLocaleString()}\\n\\n`;\n\n// System Status\nmessage += `*📊 SYSTEM RESOURCES*\\n`;\nmessage += `💾 RAM: ${data.system.mem_used}/${data.system.mem_total} (${data.system.mem_percent}%)\\n`;\nmessage += `💿 Disk: ${data.system.disk_used}/${data.system.disk_total} (${data.system.disk_percent}%)\\n`;\nmessage += `⚡ Load: ${data.system.load}\\n`;\nmessage += `💱 Swap: ${data.system.swap_used}/${data.system.swap_total}\\n\\n`;\n\n// Containers\nmessage += `*🐳 DOCKER CONTAINERS*\\n`;\nmessage += `Total: ${data.containers.total} | Healthy: ${data.containers.healthy}\\n`;\nif (data.containers.unhealthy > 0) {\n  message += `⚠️ Unhealthy: ${data.containers.unhealthy}\\n`;\n}\nmessage += `\\n`;\n\n// Websites Status\nmessage += `*🌐 WEBSITES STATUS*\\n`;\nlet allUp = true;\nfor (const site of data.websites) {\n  const emoji = site.status === 'up' ? '✅' : '❌';\n  message += `${emoji} ${site.name}: ${site.code}\\n`;\n  if (site.status === 'down') allUp = false;\n}\nmessage += `\\n`;\n\n// SSL Certificates\nmessage += `*🔒 SSL CERTIFICATES*\\n`;\nfor (const ssl of data.ssl) {\n  const emoji = ssl.days_left < 30 ? '⚠️' : '✅';\n  message += `${emoji} ${ssl.domain}: ${ssl.days_left} days\\n`;\n}\nmessage += `\\n`;\n\n// PM2\nmessage += `*⚙️ PM2 PROCESSES*\\n`;\nmessage += `Online: ${data.pm2.online}\\n\\n`;\n\n// Overall Status\nif (allUp && data.containers.unhealthy === 0 && data.system.disk_percent < 85) {\n  message += `✅ *All systems operational*`;\n} else {\n  message += `⚠️ *Attention needed*`;\n}\n\nreturn [{\n  json: {\n    message: message,\n    chat_id: '7241850736',\n    parse_mode: 'Markdown',\n    data: data\n  }\n}];"},"name":"Format Report","type":"n8n-nodes-base.code","typeVersion":2,"position":[704,304],"id":"format-report"},{"parameters":{"chatId":"@Iraqae_bot","additionalFields":{}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[912,288],"id":"929bad46-e520-4fa8-be00-446739e5e3f7","name":"Send a text message","webhookId":"dad8f5c6-958c-4562-b6c6-44bcd8571541","credentials":{"telegramApi":{"id":"IWN9JuIRwWAcDBg4","name":"Barney Telegram account"}}}],"connections":{"Every Morning 8 AM":{"main":[[{"node":"Run VPS Health Check","type":"main","index":0}]]},"Run VPS Health Check":{"main":[[{"node":"Format Report","type":"main","index":0}]]},"Format Report":{"main":[[{"node":"Send a text message","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:Every Morning 8 AM":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"6beec401-4848-4563-bc85-a341fd14a76b","triggerCount":1,"tags":[{"createdAt":"2025-10-20T13:54:03.470Z","updatedAt":"2025-10-20T13:54:03.470Z","id":"3","name":"notifications"},{"createdAt":"2025-10-20T14:15:02.436Z","updatedAt":"2025-10-20T14:15:02.436Z","id":"JPDCh26rC5nY2j0J","name":"Server"}],"shared":[{"createdAt":"2025-10-20T13:42:13.420Z","updatedAt":"2025-10-20T13:42:13.420Z","role":"workflow:owner","workflowId":"kGyEbTHbRPordSEL","projectId":"tFB2q6JWkfPj6FdL","project":{"createdAt":"2025-09-11T20:13:27.250Z","updatedAt":"2025-09-11T20:14:08.507Z","id":"tFB2q6JWkfPj6FdL","name":"Ira Watkins <iradwatkins@gmail.com>","type":"personal","icon":null,"description":null}}]}